# Render Blueprint â€” deploy SolarCommand with `render blueprint apply`
services:
  - type: web
    name: solarcommand-api
    runtime: docker
    dockerContext: ./backend
    dockerfilePath: ./backend/Dockerfile
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: solarcommand-db
          property: connectionURI
      - key: REDIS_URL
        fromService:
          type: redis
          name: solarcommand-redis
          property: connectionURI
    healthCheckPath: /health
    plan: starter

  - type: worker
    name: solarcommand-worker
    runtime: docker
    dockerContext: ./backend
    dockerfilePath: ./backend/Dockerfile
    command: celery -A app.workers.celery_app worker --loglevel=info --beat
    envVars:
      - key: DATABASE_URL_SYNC
        fromDatabase:
          name: solarcommand-db
          property: connectionURI
      - key: REDIS_URL
        fromService:
          type: redis
          name: solarcommand-redis
          property: connectionURI
    plan: starter

  - type: redis
    name: solarcommand-redis
    plan: starter
    maxmemoryPolicy: allkeys-lru

databases:
  - name: solarcommand-db
    plan: starter
    databaseName: solarcommand
    user: solar
